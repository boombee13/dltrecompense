<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏Å‡∏±‡∏î</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #fcfaf8; 
            --table-bg: #ffffff;
            --header-bg: #ffd6c9; 
            --header-text: #5e5c5c;
            --row-hover: #fff3ed; 
            --text-main: #6b6b6b;
            --btn-map: #b5ead7; 
            --btn-map-hover: #9bd6c2;
            --link-color: #a2add0; 
            --tab-bg: #f1f1f1;
            --tab-active: #ffbba6; /* ‡∏™‡∏µ Tab ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
        }
        
        body { 
            font-family: 'Sarabun', sans-serif; 
            padding: 30px 15px; 
            background-color: var(--bg-color); 
            color: var(--text-main);
            margin: 0;
            font-size: 15px; 
        }

        h2 {
            text-align: center;
            color: #7b7b7b;
            margin-bottom: 20px;
            font-weight: 600;
        }

        /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Tab ‡πÄ‡∏°‡∏ô‡∏π */
        .tabs-container {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap; /* ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
        }

        .tab-btn {
            font-family: 'Sarabun', sans-serif; 
            padding: 10px 24px;
            border: none;
            background-color: var(--tab-bg);
            color: var(--text-main);
            border-radius: 25px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            background-color: #e2e2e2;
        }

        .tab-btn.active {
            background-color: var(--tab-active);
            color: white;
            box-shadow: 0 4px 10px rgba(255, 187, 166, 0.4);
        }

        /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        .table-container {
            border-radius: 16px;
            overflow-x: auto; /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏ß‡∏≤‡πÑ‡∏î‡πâ */
            -webkit-overflow-scrolling: touch; 
            box-shadow: 0 8px 24px rgba(0,0,0,0.04);
            background: var(--table-bg);
            max-width: 1100px;
            margin: 0 auto; 
        }

        table { 
            width: 100%; 
            border-collapse: collapse; 
            min-width: 800px; /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ö‡∏µ‡∏¢‡∏î‡∏Å‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ */
        }

        th, td { 
            padding: 16px 20px; 
            text-align: left; 
            border-bottom: 1px solid #f4f4f4; 
            white-space: nowrap; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà */
        }

        th { 
            background-color: var(--header-bg); 
            color: var(--header-text); 
            font-weight: 600;
            font-size: 16px;
        }

        tr:last-child td { border-bottom: none; }
        tr:hover td { background-color: var(--row-hover); transition: background 0.2s ease; }

        a.link-text { color: var(--link-color); text-decoration: none; font-weight: 600; }
        a.link-text:hover { text-decoration: underline; }

        a.btn { 
            display: inline-block; 
            padding: 8px 18px; 
            background: var(--btn-map); 
            color: #5a7065; 
            text-decoration: none; 
            border-radius: 20px; 
            font-size: 14px; 
            font-weight: 600;
            transition: all 0.3s ease;
        }
        a.btn:hover { background: var(--btn-map-hover); transform: translateY(-1px); }
        
        .status-badge {
            background-color: #f1f1f1;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 14px;
            color: #777;
        }
    </style>
</head>
<body>

    <h2>‚ú® ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h2>
    
    <div class="tabs-container">
        <button class="tab-btn active" onclick="filterData('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', this)">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (All)</button>
        <button class="tab-btn" onclick="filterData('‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', this)">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</button>
        <button class="tab-btn" onclick="filterData('Moved', this)">‡∏¢‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß (Moved)</button>
    </div>
    
    <div class="table-container">
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Link</th>
                    <th>Sub District</th>
                    <th>District</th>
                    <th>Location</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr><td colspan="7" style="text-align:center; padding: 30px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        // üö® ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÉ‡∏™‡πà API URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üö®
        const API_URL = 'https://script.google.com/macros/s/AKfycbwoKn0sBWgxZVHenqQJn-ky8ttWxREAoZykk4qnCUMEsBP48KyXhCC2upufaPzlJXo/exec'; 
        
        let allData = []; // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤

        async function fetchData() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                
                const getValue = (row, keyName) => {
                    const actualKey = Object.keys(row).find(k => k.trim() === keyName);
                    return actualKey ? row[actualKey] : '';
                };

                // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ Date ‡∏´‡∏£‡∏∑‡∏≠ Link ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ allData
                allData = data.filter(row => {
                    const dateVal = getValue(row, 'Date');
                    const linkVal = getValue(row, 'Link');
                    return (dateVal !== '' && dateVal !== undefined) || (linkVal !== '' && linkVal !== undefined);
                }).map(row => {
                    // ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô
                    return {
                        date: getValue(row, 'Date'),
                        time: getValue(row, 'Time'),
                        link: getValue(row, 'Link'),
                        subDistrict: getValue(row, 'Sub District'),
                        district: getValue(row, 'District'),
                        location: getValue(row, 'Location'),
                        status: getValue(row, 'Status') || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£'
                    };
                });

                // ‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" ‡∏Å‡πà‡∏≠‡∏ô
                renderTable(allData);

            } catch (error) {
                console.error('Error fetching data:', error);
                document.querySelector('#dataTable tbody').innerHTML = '<tr><td colspan="7" style="text-align:center; padding: 40px; color: #ff8b8b;">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function renderTable(dataToRender) {
            const tbody = document.querySelector('#dataTable tbody');
            tbody.innerHTML = ''; 

            if (dataToRender.length === 0) {
                 tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding: 40px; color: #aaa;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏µ‡πâ</td></tr>';
                 return;
            }

            dataToRender.forEach(row => {
                const tr = document.createElement('tr');
                const linkImg = row.link ? `<a href="${row.link}" class="link-text" target="_blank">‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</a>` : '-';
                const linkMap = row.location ? `<a href="${row.location}" class="btn" target="_blank">‡πÄ‡∏õ‡∏¥‡∏î Google Maps</a>` : '-';

                tr.innerHTML = `
                    <td>${row.date || '-'}</td>
                    <td>${row.time || '-'}</td>
                    <td>${linkImg}</td>
                    <td>${row.subDistrict || '-'}</td>
                    <td>${row.district || '-'}</td>
                    <td>${linkMap}</td>
                    <td><span class="status-badge">${row.status}</span></td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Tab
        function filterData(statusFilter, btnElement) {
            // ‡∏•‡∏ö class 'active' ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏ñ‡∏π‡∏Å‡∏Å‡∏î
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            btnElement.classList.add('active');

            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            if (statusFilter === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î') {
                renderTable(allData);
            } else {
                const filteredData = allData.filter(row => row.status === statusFilter);
                renderTable(filteredData);
            }
        }

        // ‡∏™‡∏±‡πà‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        fetchData();
    </script>
</body>
</html>
